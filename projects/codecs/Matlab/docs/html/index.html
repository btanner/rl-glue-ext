<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>RL-Glue Matlab Codec</TITLE>
<META NAME="description" CONTENT="RL-Glue Matlab Codec">
<META NAME="keywords" CONTENT="MatlabCodec">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="MatlabCodec.css">

</HEAD>

<BODY >
<!--Navigation Panel-->
<IMG WIDTH="81" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next_inactive" SRC="nx_grp_g.png"> 
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_g.png"> 
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev_g.png">   
<BR>
<BR>
<BR>
<!--End of Navigation Panel-->
<H1 ALIGN="CENTER">RL-Glue Matlab Codec 1.0 Manual </H1>
<DIV>

<P ALIGN="CENTER"><STRONG>Brian Tanner :: brian@tannerpages.com</STRONG></P>
</DIV>
<BR>

<H2><A NAME="SECTION00010000000000000000">
Contents</A>
</H2>
<!--Table of Contents-->

<UL>
<LI><A NAME="tex2html66"
  HREF="MatlabCodec.html#SECTION00020000000000000000">Introduction</A>
<UL>
<LI><A NAME="tex2html67"
  HREF="MatlabCodec.html#SECTION00021000000000000000">Software Requirements</A>
<LI><A NAME="tex2html68"
  HREF="MatlabCodec.html#SECTION00022000000000000000">Getting the Codec</A>
<LI><A NAME="tex2html69"
  HREF="MatlabCodec.html#SECTION00023000000000000000">Installing the Codec</A>
<LI><A NAME="tex2html70"
  HREF="MatlabCodec.html#SECTION00024000000000000000">Removing the Codec</A>
</UL>
<BR>
<LI><A NAME="tex2html71"
  HREF="MatlabCodec.html#SECTION00030000000000000000">Gotchas!</A>
<UL>
<LI><A NAME="tex2html72"
  HREF="MatlabCodec.html#SECTION00031000000000000000">Disconnect your Agent/Environment/Experiment</A>
<LI><A NAME="tex2html73"
  HREF="MatlabCodec.html#SECTION00032000000000000000">One Component At A Time</A>
</UL>
<BR>
<LI><A NAME="tex2html74"
  HREF="MatlabCodec.html#SECTION00040000000000000000">Sample Project</A>
<UL>
<LI><A NAME="tex2html75"
  HREF="MatlabCodec.html#SECTION00041000000000000000">Skeleton Agent</A>
<LI><A NAME="tex2html76"
  HREF="MatlabCodec.html#SECTION00042000000000000000">Skeleton Environment</A>
<LI><A NAME="tex2html77"
  HREF="MatlabCodec.html#SECTION00043000000000000000">Skeleton Experiment</A>
<LI><A NAME="tex2html78"
  HREF="MatlabCodec.html#SECTION00044000000000000000">Putting it all together</A>
<LI><A NAME="tex2html79"
  HREF="MatlabCodec.html#SECTION00045000000000000000">Going Further - Mines Sarsa Example Project</A>
</UL>
<BR>
<LI><A NAME="tex2html80"
  HREF="MatlabCodec.html#SECTION00050000000000000000">Who creates and frees memory?</A>
<LI><A NAME="tex2html81"
  HREF="MatlabCodec.html#SECTION00060000000000000000">Advanced Features</A>
<UL>
<LI><A NAME="tex2html82"
  HREF="MatlabCodec.html#SECTION00061000000000000000">Task Specification Parser</A>
<LI><A NAME="tex2html83"
  HREF="MatlabCodec.html#SECTION00062000000000000000">Connecting on custom ports to custom hosts</A>
</UL>
<BR>
<LI><A NAME="tex2html84"
  HREF="MatlabCodec.html#SECTION00070000000000000000">Codec Specification Reference</A>
<UL>
<LI><A NAME="tex2html85"
  HREF="MatlabCodec.html#SECTION00071000000000000000">Types</A>
<LI><A NAME="tex2html86"
  HREF="MatlabCodec.html#SECTION00072000000000000000">Functions</A>
</UL>
<BR>
<LI><A NAME="tex2html87"
  HREF="MatlabCodec.html#SECTION00080000000000000000">Frequently Asked Questions</A>
<UL>
<LI><A NAME="tex2html88"
  HREF="MatlabCodec.html#SECTION00081000000000000000">Where can I get more help?</A>
</UL>
<BR>
<LI><A NAME="tex2html89"
  HREF="MatlabCodec.html#SECTION00090000000000000000">Credits and Acknowledgements</A>
<UL>
<LI><A NAME="tex2html90"
  HREF="MatlabCodec.html#SECTION00091000000000000000">Contributing</A>
</UL></UL>
<!--End of Table of Contents-->
<P>

<H1><A NAME="SECTION00020000000000000000">
Introduction</A>
</H1>

<P>
This document describes how to use the Matlab RL-Glue Codec, a software library that provides socket-compatibility with the RL-Glue Reinforcement Learning software library.  Matlab is a brand new codec, created specifically for the RL-Glue 3.0 release.  Special thanks (or pokes) should go to Dale, Doina, and Yaki who gave voices to the countless others who probably
have scorned us for not supporting Matlab earlier.  It turned out to not even be that difficult :)

<P>
For general information and motivation about the RL-Glue<A NAME="tex2html1"
  HREF="#foot216"><SUP>1</SUP></A> project, please refer to the documentation provided with that project.

<P>
This codec will allow you to create agents, environments, and experiment programs in Matlab.

<P>
This software project is licensed under the Apache-2.0<A NAME="tex2html3"
  HREF="#foot217"><SUP>2</SUP></A> license. We're not lawyers, but our intention is that this code 
should be used however it is useful.  We'd appreciate to hear what you're using it for, and to get credit if appropriate.

<P>
This project has a home here:
<BR><TT><A NAME="tex2html5"
  HREF="http://glue.rl-community.org/Home/Extensions/matlab-codec">http://glue.rl-community.org/Home/Extensions/matlab-codec</A></TT>
<P>

<H2><A NAME="SECTION00021000000000000000">
Software Requirements</A>
</H2>
To run agents, environments, and experiments created with this codec, you will need to have RL-Glue installed on your computer.

<P>
Compiling and running components with this codec requires Matlab.  The codec was developed on Matlab 7.6.0.x, it has not been tested extensively on other versions.  This Matlab codec uses the RL-Glue Java Extension, which means that Matlab needs to be running with the Java Virtual Machine enabled (it is by default).  The Java extension does not need to be installed independently.

<P>
<B>Possible Contribution: </B>Someone with Matlab experience could help us find out what version of Matlab is required to use this codec, and could help us update the codec
to be as robust as possible to older versions.

<P>

<H2><A NAME="SECTION00022000000000000000">
Getting the Codec</A>
</H2>
The codec can be downloaded either as a tarball or can be checked out of the subversion repository where it is hosted.

<P>
The tarball distribution can be found here:
<BR>
<TT><A NAME="tex2html6"
  HREF="http://code.google.com/p/rl-glue-ext/downloads/list">http://code.google.com/p/rl-glue-ext/downloads/list</A></TT>
<P>
To check the code out of subversion:
<BR>
<FONT SIZE="-1"><TT>svn checkout http://rl-glue-ext.googlecode.com/svn/trunk/projects/codecs/Matlab Matlab-Codec</TT> </FONT>
<P>

<H2><A NAME="SECTION00023000000000000000">
Installing the Codec</A>
</H2>
This codec is package with a Matlab ``installer'' which copies the codec source files and the RL-Glue Java Extension JAR file to a user-configurable location and adds them to your Matlab path and Matlab Java classpaths.  This is the recommended way of using the codec.  Alternatively, you can skip the installer and setup these paths on your own.   This manual will assume that you are using the installer.

<P>
To run the installer, use the <TT>installRLGlue()</TT> function from within Matlab in the main directory of the package you downloaded.  This will suggest installing Matlab to your home directory at <TT>~/rl-glue/codecs/matlab</TT>.  If you would prefer an alternate location, you can call the function with a path, like:
<PRE>
	&gt;&gt;installRLGlue('~/desired/path/to/codec')
</PRE>

<P>

<H2><A NAME="SECTION00024000000000000000">
Removing the Codec</A>
</H2>
The Matlab codec can be uninstalled by deleting the directory that you installed it (eg. <TT>~/rl-glue/codecs/matlab</TT>), and using the Matlab path editor to remove the associated directories from your path.

<P>

<H1><A NAME="SECTION00030000000000000000">
Gotchas!</A>
</H1>

<H2><A NAME="SECTION00031000000000000000">
Disconnect your Agent/Environment/Experiment</A>
</H2>
Matlab is not really multithreaded.  This means that when Matlab is listening for a command from the network, it cannot be interrupted easily. Issuing the  <TT>CTRL-c</TT> command will not bring Matlab back when it is waiting to connect to <TT>rl_glue</TT>.  It also means in some crash cases, Matlab will hang, or Matlab will come back to you, but the socket will not close properly so it will hang next time you try to make a connection.

<P>
If your agent/environment/experiment crashes or terminates prematurely, you should manually disconnect your Matlab component so that the <TT>Java</TT> socket gets cleaned up.  Depending on what you were running, the code would be:
<PRE>
	&gt;&gt; disconnectAgent()                 %For agents
	&gt;&gt; disconnectEnvironment()           %For environments
	&gt;&gt; disconnectGlue()                  %For experiments
</PRE>

<P>
If you don't disconnect manually in these cases, Matlab can get hung up and you'll have to restart it.

<P>
If Matlab is otherwise hanging because it is blocked waiting on the network, you can sometimes bring it back by using <TT>CTRL-c</TT> and then making a network operation happen.  For example, if you started up an agent, and then decided you want to stop it, you could first do  <TT>CTRL-c</TT>.  There will be no feedback that anything happened, Matlab will stay hung. Then, go to your terminal/console and start <TT>rl_glue</TT>.  The <TT>CTRL-c</TT> you did in Matlab will be processed after the agent connects to <TT>rl_glue</TT> and you will be able to <TT>disconnectAgent()</TT> and continue.

<P>
<B>Possible contribution:</B>  help make Matlab networking more reliable.  If anyone has experience, ideas, or enthusiasm, we would very much like to make Matlab more robust to communication and network problems like those described above.  They are quite frustrating.  If you are interested in helping, please contact us.

<P>

<H2><A NAME="SECTION00032000000000000000"></A>
<A NAME="one-at-a-time"></A>
<BR>
One Component At A Time
</H2>
Because Matlab is inherently single threaded, we had limit each Matlab instance to running a single component at a time.  This means that you can only run ONE of an agent OR environment OR experiment in Matlab at a time.  If you are able to open multiple Matlab instances, you can run one
component per instance.  We think that the usual case will probably be to run your agent in Matlab, but run the experiment and environment in another language, like Java, C, or Python.

<P>
We may lift find a clever way to lift this restriction in the future, or create a local glue engine so that all three can run together inside Matlab without the network.

<P>

<H1><A NAME="SECTION00040000000000000000">
Sample Project</A>
</H1>
We have included two example projects with this codec, located in the <TT>examples</TT> directory.  Each project contains an agent, environment, and experiment written for this Matlab codec.  The two projects are <TT>skeleton</TT> and <TT>mines-sarsa-sample</TT>.

<P>
The <TT>skeleton</TT> contains all of the bare-bones plumbing that is required to create an agent/environment/experiment with this codec and might be a good starting point for creating your own components.

<P>
The <TT>mines-sarsa-sample</TT> contains a fully functional tabular Sarsa learning algorithm, a discrete-observation grid world problem, and an experiment program that can run these together and gather results.  More details below in Section <A HREF="#mines-sarsa-sample">3.5</A>.

<P>
In the following sections, we will describe the skeleton project.  Running and using the <TT>mines-sarsa-sample</TT> is analogous.

<P>

<H2><A NAME="SECTION00041000000000000000"></A>
<A NAME="sec:agent"></A>
<BR>
Skeleton Agent
</H2>
We have provided a skeleton agent with the codec that is a good starting point for agents that you may write in the future.
It implements all the required functions and provides a good example of how create and run a simple agent.

<P>
There are several functions that need to be written. They are all contained in a single Matlab source file:
<PRE>
	examples/skeleton/skeleton_agent.m
</PRE>

<P>
The <TT>skeleton_agent.m</TT> file has a public function that returns a structure with function pointers to all of the required RL-Glue functions.  The structure looks like this:

<P>
<PRE>
&gt;&gt; theAgent=skeleton_agent()

theAgent = 

       agent_init: @skeleton_agent_init
      agent_start: @skeleton_agent_start
       agent_step: @skeleton_agent_step
        agent_end: @skeleton_agent_end
    agent_cleanup: @skeleton_agent_cleanup
    agent_message: @skeleton_agent_message
</PRE>

<P>
Alternatively, these different functions could each be in their own <TT>skeleton_agent_</TT>{init, start, step, end, cleanup, message}<TT>.m</TT> files.  This is a personal choice.

<P>
This agent does not learn anything and randomly chooses integer action 0 or 1.  

<P>
You can compile and run the agent like:
<PRE>
	&gt;$ cd examples/skeleton
	&gt;$ theAgent=skeleton_agent();
	&gt;$ runAgent(theAgent);
</PRE>

<P>
<A NAME="tex2html7"
  HREF="http://code.google.com/p/rl-glue-ext/source/browse/trunk/projects/codecs/Matlab/examples/skeleton/skeleton_agent.m"><TT>skeleton_agent()</TT></A>
creates a struct with function pointers to the other <TT>skeleton_agent</TT> methods.  <A NAME="tex2html8"
  HREF="http://code.google.com/p/rl-glue-ext/source/browse/trunk/projects/codecs/Matlab/src/agent/runAgent.m"><TT>runAgent(theAgent)</TT></A>
then
connects to RL-Glue and runs one step at a time until RL-Glue disconnects.

<P>
Alternatively, for a more interactive experience, you can run the agent manually one step at a time:
<PRE>
	&gt;$ cd examples/skeleton/
	&gt;$ theAgent=skeleton_agent()
	&gt;$ connectAgent(theAgent);
	&gt;$ runAgentLoop(theAgent);    %run one step
	&gt;$ runAgentLoop(theAgent);    %run one step
	&gt;$ runAgentLoop(theAgent);    %run one step
	   ...
</PRE>

<P>
Using this method, you can stop and examine what your agent is learning, and potentially modify, visualize, or analyze it however you like.

<P>
You will see something like:
<PRE>
	&gt;&gt; runAgent(theAgent)
	RL-Glue Matlab Agent Codec Version: 1.0 ($Revision: 491 $)
	    Connecting to rl_glue at host: localhost on port 4096
</PRE>

<P>
This means that the skeleton_agent is running, and trying to connect to the <TT>rl_glue</TT> executable server on the local machine through port 4096! 

<P>
You can kill the process by pressing <TT>CTRL-c</TT> on your keyboard, and then starting  <TT>rl_glue</TT> on your local machine (this will cause Matlab to come back from Java, and 
process your kill command).  Don't forget to <TT>disconnectAgent()</TT>.

<P>
We're sorry that killing an agent (or environment) is so kludgy.  This is the first version of the Matlab codec, so there are some kinks to get out.  We welcome your expertise in helping 
make this codec better!

<P>
The Skeleton agent is very simple and well documented, so we won't spend any more time talking about it in these instructions.
Please open it up and take a look.

<P>

<H2><A NAME="SECTION00042000000000000000"></A>
<A NAME="sec:env"></A>
<BR>
Skeleton Environment
</H2>

<P>
We have provided a skeleton environment with the codec that is a good starting point for environments that you may write in the future.
It implements all the required functions and provides a good example of how to compile a simple environment.  This section will follow the same 
pattern as the agent version (Section <A HREF="#sec:agent">3.1</A>).  This section will be less detailed because many ideas are similar or identical.

<P>
The pertinent file is:
<PRE>
	examples/skeleton/skeleton_environment.m
</PRE>

<P>
This environment is episodic, with 21 states, labeled <!-- MATH
 $\{0, 1,\ldots,19,20\}$
 -->
<IMG
 WIDTH="128" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img1.png"
 ALT="$\{0, 1,\ldots,19,20\}$">. States {0, 20} are terminal and return rewards of {-1, +1} respectively.  The other states return reward of 0.
There are two actions, {0, 1}.  Action 0 decrements the state number, and action 1 increments it. The environment starts in state 10.

<P>
You can compile and run the environment like:
<PRE>
	&gt;$ cd examples/skeleton
	&gt;$ theEnv=skeleton_environment();
	&gt;$ runEnvironment(theEnv);
</PRE>

<P>
You will see something like:
<PRE>
	RL-Glue Matlab Environment Codec Version: 1.0 ($Revision: 491 $)
	    Connecting to rl_glue at host: localhost on port 4096
</PRE>

<P>
This means that the skeleton_environment is running, and trying to connect to the <TT>rl_glue</TT> executable server on the local machine through port 4096! 

<P>
You can kill the process by pressing <TT>CTRL-c</TT> on your keyboard, and then starting  <TT>rl_glue</TT> on your local machine (this will cause Matlab to come back from Java, and 
process your kill command).  Don't forget to <TT>disconnectEnvironment()</TT>.

<P>
The Skeleton environment is very simple and well documented, so we won't spend any more time talking about it in these instructions.
Please open it up and take a look.

<P>

<H2><A NAME="SECTION00043000000000000000">
Skeleton Experiment</A>
</H2>
We have provided a skeleton experiment with the codec that is a good starting point for experiments that you may write in the future.
It implements all the required functions and provides a good example of how to compile a simple experiment.  This section will follow the same 
pattern as the agent version (Section <A HREF="#sec:agent">3.1</A>).  This section will be less detailed because many ideas are similar or identical.

<P>
The pertinent files are:
<PRE>
	examples/skeleton/skeleton_experiment.m
</PRE>

<P>
This experiment runs <TT>RL_Episode</TT> a few times, sends some messages to the agent and environment, and then steps through one episode using <TT>RL_step</TT>.

<P>
<PRE>
	&gt;$ cd examples/skeleton
	&gt;$ skeleton_experiment();
</PRE>

<P>
You will see something like:
<PRE>
	Experiment starting up!
	RL-Glue Matlab Experiment Codec Version: 1.0 ($Revision: 491 $)
	    Connecting to rl_glue at host: 127.0.0.1 on port 4096
</PRE>

<P>
This means that the skeleton_experiment is running, and trying to connect to the <TT>rl_glue</TT> executable server on the local machine through port 4096!  

<P>
You can kill the process by pressing <TT>CTRL-c</TT> on your keyboard, and then starting  <TT>rl_glue</TT> on your local machine (this will cause Matlab to come back from Java, and 
process your kill command).  Don't forget to <TT>disconnectGlue()</TT>.

<P>
The Skeleton experiment is very simple and well documented, so we won't spend any more time talking about it in these instructions.
Please open it up and take a look.

<P>

<H2><A NAME="SECTION00044000000000000000">
Putting it all together</A>
</H2>
At this point, we've run each of the three components, now it's time to run them with the <TT>rl_glue</TT> executable server.  As mentioned in Section <A HREF="#one-at-a-time">2.2</A>, in Matlab we can 
only run ONE of the agent, experiment, or environment at a time.  So, for this example we'll run the <TT>Java SkeletonAgent</TT> and <TT>Java SkeletonEnvironment</TT> with the <TT>Matlab skeleton_experiment</TT>.  You could really run any agent and environment of your choice.

<P>
The following will work if you have the <TT>rl_glue</TT> socket server installed on your path(the default location), and the Java RL-Glue Extension<A NAME="tex2html9"
  HREF="#foot222"><SUP>3</SUP></A> installed.

<P>
For this, we'll use a separate terminal window in addition to the Matlab interpreter.  In a separate terminal window, do:
<PRE>
	&gt;$ cd /path/to/Java/codec/examples/skeleton
	&gt;$ rl_glue &amp;
	&gt;$ javac *.java
	&gt;$ java SkeletonAgent &amp;
	&gt;$ java SkeletonEnvironment &amp;
</PRE>

<P>
In the Matlab interpreter:
<PRE>
	&gt;$ cd examples/skeleton
	&gt;$ skeleton_experiment();
</PRE>

<P>
If RL-Glue is not installed in the default location, you'll have to start the <TT>rl_glue</TT> executable server using its full path (unless it's in your <TT>PATH</TT> environment variable):
<PRE>
	&gt;$ /path/to/rl-glue/bin/rl_glue &amp;
</PRE>

<P>
In the Matlab window, you should see the following if it worked:
<PRE>
	&gt;&gt; skeleton_experiment()
	Experiment starting up!
	RL-Glue Matlab Experiment Codec Version: 1.0 ($Revision: 491 $)
	    Connecting to rl_glue at host: 127.0.0.1 on port 4096
	    Experiment Codec Connected
	RL_init called, the environment sent task spec: VERSION RL-Glue-3.0 PROBLEMTYPE episodic 
	DISCOUNTFACTOR 1.0 OBSERVATIONS INTS (0 20)  ACTIONS INTS (0 1) 
	REWARDS (-1.0 1.0)  EXTRA skeleton_environment(Matlab) by Brian Tanner.

	----------Sending some sample messages----------
	Agent responded to 'what is your name?' with: my name is skeleton_agent, Java edition!
	Agent responded to 'If at first you do't succeed; call it version 1.0  ' 
	with: I don't know how to respond to your message

	Environment responded to 'what is your name?' with: my name is skeleton_environment, Java edition!
	Environment responded to 'If at first you don't succeed; call it version 1.0  ' 
	with: I don't know how to respond to your message


	----------Running a few episodes----------
	Episode 0	 10 steps 	 -1.000000 total reward	 natural end 1
	Episode 1	 10 steps 	 -1.000000 total reward	 natural end 1
	Episode 2	 10 steps 	 -1.000000 total reward	 natural end 1
	Episode 3	 10 steps 	 -1.000000 total reward	 natural end 1
	Episode 4	 10 steps 	 -1.000000 total reward	 natural end 1
	Episode 5	 1 steps 	 0.000000 total reward	 natural end 0
	Episode 6	 10 steps 	 -1.000000 total reward	 natural end 1


	----------Stepping through an episode----------
	First observation and action were: 10 and: 0


	----------Summary----------
	It ran for 10, total reward was: -1.000000
</PRE>

<P>
Congratulations, you have run an RL-Glue experiment using the Matlab codec!  You can mix and match the Matlab agent/environment/experiment with the appropriate sample skeleton agent/environment/experiments from any other codec.

<P>

<H2><A NAME="SECTION00045000000000000000"></A>
<A NAME="mines-sarsa-sample"></A>
<BR>
Going Further - Mines Sarsa Example Project
</H2>
The <TT>skeleton</TT> sample project is extremely limited and only shows the mechanics of how RL-Glue components are structured using the Matlab codec.  The <TT>mines-sarsa</TT> sample project is much richer.

<P>

<H3><A NAME="SECTION00045100000000000000"></A>
<A NAME="mines-sample"></A>
<BR>
Sample-Mines-Environment
</H3>
The 
<A NAME="tex2html13"
  HREF="http://code.google.com/p/rl-glue-ext/source/browse/trunk/projects/codecs/Matlab/examples/mines-sarsa-sample/sample_mines_environment.m">mines environment</A>
is internally a two-dimensional, discrete grid world where the agent receives a penalty per step until reaching a goal state, hopefully without stepping on any exploding land-mines along the way.  The (x,y) state is flattened into a discrete, scalar observation for the agent.  This environment can receive special messages from the experiment program to print the current state to the screen, and also to toggle between random starting states and a fixed starting-state specified by the experiment.

<P>
The task specification string<A NAME="tex2html11"
  HREF="#foot223"><SUP>4</SUP></A> is created in a semi-automated way using the Java RL-Glue Extension task spec parser/builder. 

<P>

<H3><A NAME="SECTION00045200000000000000"></A>
<A NAME="sarsa-sample"></A>
<BR>
Samples-Sarsa-Agent
</H3>
The 
<A NAME="tex2html14"
  HREF="http://code.google.com/p/rl-glue-ext/source/browse/trunk/projects/codecs/Matlab/examples/mines-sarsa-sample/sample_sarsa_agent.m">SARSA agent</A>
is a tabular learning agent that uses <!-- MATH
 $\epsilon-greedy$
 -->
<IMG
 WIDTH="84" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\epsilon-greedy$"> exploration as described in <A NAME="tex2html15"
  HREF="http://www.cs.ualberta.ca/~sutton/book/ebook/node64.html">Reinforcement Learning: An Introduction</A>
by Sutton and Barto.

<P>
The SARSA agent parses the task specification string using the Java RL-Glue Extension task spec parser.  This agent can receive special messages from the experiment program to pause/unpause learning, pause/unpause exploring, save the current value function to a file, and load the the value function from a file.

<P>

<H3><A NAME="SECTION00045300000000000000">
Sample-Experiment</A>
</H3>
The sample experiment program runs the show.  First, it alternates running the agent in the environment for a number of episodes, and telling the agent to pause learning so that the current performance can be evaluated.  These results are plotted with error-bars in a Matlab figure.

<P>
The sample experiment then tells the agent to save the value function to a file, and then resets the experiment (and agent) to initial conditions.  After verifying that the agent's initial policy is bad, the experiment tells the agent to load the value function from the file.  The agent is evaluated again using this previously-learned value function, and performance is dramatically better.

<P>
Finally, the experiment sends a message to specify that the environment should use a fixed (instead of random) starting state, and runs the agent from that fixed start state for a while.

<P>

<H1><A NAME="SECTION00050000000000000000">
Who creates and frees memory?</A>
</H1>
The RL-Glue technical manual has a section called <I>Who creates and frees memory?</I>.  The general approach recommended there is to make a copy of data you want to keep beyond the method it was given to you.  The same rules of thumb from that manual should be followed when using the Matlab codec.  The observations and actions can be copied using the same techniques as <A NAME="tex2html16"
  HREF="http://glue.rl-community.org/Home/Extensions/java-codec">the RL-Glue Java Extension</A>.

<P>

<H1><A NAME="SECTION00060000000000000000">
Advanced Features</A>
</H1>

<H2><A NAME="SECTION00061000000000000000">
Task Specification Parser</A>
</H2>
As of fall 2008, we've updated the task specification language:
<BR><TT><A NAME="tex2html17"
  HREF="http://glue.rl-community.org/Home/rl-glue/task-spec-language">http://glue.rl-community.org/Home/rl-glue/task-spec-language</A></TT>
<P>
The Matlab codec uses the task spec parser implementation from the RL-Glue Java Extension.  This task spec parser/builder can be used in environments to create task specification strings for <TT>env_init</TT>.  The sample mines environment in Section <A HREF="#mines-sample">3.5.1</A> provides an example of creating a task spec in this way.  There are also several advanced examples of this in the RL-Library<A NAME="tex2html18"
  HREF="#foot224"><SUP>5</SUP></A>.  The task spec parser/builder can also be used by agents to decode the task spec string for <TT>agent_init</TT>.  The sample sarsa agent in Section <A HREF="#sarsa-sample">3.5.2</A> demonstrates how to do this.

<P>

<H2><A NAME="SECTION00062000000000000000">
Connecting on custom ports to custom hosts</A>
</H2>
This section will explain how to set custom target IP addresses (to connect over the network) and custom ports (to run multiple experiments on one machine or to avoid firewall issues).
Sometimes you will want run the <TT>rl_glue</TT> server on a port other than the default
(4096) either because of firewall issues, or because you want to run multiple instances on the same machine.

<P>
In these cases, you can tell your Matlab agent, environment, or experiment program to connect on a custom port and/or to a custom host using the  <TT>RL_set_port()</TT> and <TT>RL_set_host()</TT> Matlab functions.

<P>
For example, the following code:
<PRE>
&gt;&gt; RL_set_port(4097);
&gt;&gt; RL_set_host('yahoo.ca')
&gt;&gt; cd examples/skeleton
&gt;&gt; skeleton_experiment();
</PRE>

<P>
That command could give output like:
<PRE>
	RL-Glue Matlab Experiment Codec Version: 1.0 ($Revision: 491 $)
	     Connecting to rl_glue at host: yahoo.ca on port 4097
</PRE>

<P>
This works for agents, environments, and experiments.  In practice though, remember that yahoo.ca probably isn't running an RL-Glue server.

<P>
You can specify the port, the host, neither, or both.  Ports must be numbers, hosts can be hostnames or ip addresses. Default port value is 4096 and host is 127.0.0.1.

<P>
Remember, on most *nix systems, you need <TT>superuser</TT> privileges to listen on ports lower than 1024, so you probably want to pick one higher than that.

<P>

<H1><A NAME="SECTION00070000000000000000">
Codec Specification Reference</A>
</H1>
This section will explain how the RL-Glue types and functions are defined for this codec.  This isn't meant to be the most exciting section of this document, but it will
be handy.

<P>
Instead of re-creating information that is readily available in the MatlabDocs, we will give pointers were appropriate.

<P>

<H2><A NAME="SECTION00071000000000000000">
Types</A>
</H2>

<P>

<H3><A NAME="SECTION00071100000000000000">
Simple Types</A>
</H3>
Unlike the C/C++ codec, we will not be using <TT>typedef</TT> statements to create special labels for the types. Since Matlab is loosely typed, these things aren't so hard and 
fast:

<UL>
<LI><I>reward</I> is <TT>double</TT>
</LI>
<LI><I>terminal</I> is <TT>int</TT> (1 for terminal, 0 for non-terminal) We hope to replace these with boolean eventually.
</LI>
<LI><I>messages</I> come as Java <TT>strings</TT> and can be returned as Matlab strings
</LI>
<LI><I>task specifications</I> come as Java <TT>strings</TT> and can be returned as Matlab strings
</LI>
</UL>

<P>

<H3><A NAME="SECTION00071200000000000000"></A>
<A NAME="sec:structure-types"></A>
<BR>
Structure Types
</H3>
All of the major structure types (observations, actions) come off the network as the appropriate object from the Java codec.
The <A NAME="tex2html20"
  HREF="http://glue.rl-community.org/Home/Extensions/java-codec">Java codec manual</A>
should have all the information required to understand those objects.

<P>
So in a given Matlab method, like <BR>
<TT>function theAction=skeleton_agent_step(theReward, theObservation)</TT>, 
<TT>theObservation</TT> is actually of type: <TT>org.rlcommunity.rlglue.codec.types.Observation</TT>.

<P>
Java and Matlab play very well together, so you can do things like:
<PRE>
	&gt;&gt; testObs=org.rlcommunity.rlglue.codec.types.Observation();
	&gt;&gt; testObs.intArray=[1 2 3 4];
	&gt;&gt; testObs.doubleArray=[0.1 0.5];
	&gt;&gt; testObs.charArray='fun things!';
	&gt;&gt; testObs.toString()

	ans =

	numInts: 4
	numDoubles: 2
	numChars: 11
	 1 2 3 4 0.1 0.5 f u n   t h i n g s !
</PRE>

<P>

<H2><A NAME="SECTION00072000000000000000">
Functions</A>
</H2>

<H3><A NAME="SECTION00072100000000000000">
Agent Functions</A>
</H3>
All agent constructor functions <B>should set</B> the same functions as our <A NAME="tex2html21"
  HREF="http://code.google.com/p/rl-glue-ext/source/browse/trunk/projects/codecs/Matlab/examples/skeleton_agent/skeleton_agent_construct.m">Skeleton agent</A>.

<P>
Useful utility methods for connecting, disconnecting, and running with the <TT>rl_glue</TT> executable server are in the <A NAME="tex2html22"
  HREF="http://code.google.com/p/rl-glue-ext/source/browse/trunk/projects/codecs/Matlab/src/agent"><TT>agent</TT></A>
directory of the Matlab codec source.

<P>

<H3><A NAME="SECTION00072200000000000000">
Environment Functions</A>
</H3>
All environment constructor functions <B>should set</B> the same functions as our <A NAME="tex2html23"
  HREF="http://code.google.com/p/rl-glue-ext/source/browse/trunk/projects/codecs/Matlab/examples/skeleton_environment/skeleton_environment.m">Skeleton environment</A>.

<P>
Useful utility methods for connecting, disconnecting, and running with the <TT>rl_glue</TT> executable server are in the <A NAME="tex2html24"
  HREF="http://code.google.com/p/rl-glue-ext/source/browse/trunk/projects/codecs/Matlab/src/environment"><TT>environment</TT></A>
directory of the Matlab codec source.

<P>

<H3><A NAME="SECTION00072300000000000000">
Experiments Functions</A>
</H3>
All experiments <B>can call</B> the methods in the  <A NAME="tex2html25"
  HREF="http://code.google.com/p/rl-glue-ext/source/browse/trunk/projects/codecs/Matlab/src/glue"><TT>glue</TT></A>
directory.
In this case we'll include their prototypes, because the source file is full of implementation details.

<P>

<H1><A NAME="SECTION00080000000000000000">
Frequently Asked Questions</A>
</H1>
We're waiting to hear your questions!

<P>

<H2><A NAME="SECTION00081000000000000000">
Where can I get more help?</A>
</H2>

<H3><A NAME="SECTION00081100000000000000">
Online FAQ</A>
</H3>
We suggest checking out the online RL-Glue Matlab Codec FAQ:
<BR>
<TT><A NAME="tex2html26"
  HREF="http://glue.rl-community.org/Home/Extensions/matlab-codec#TOC-Frequently-Asked-Questions">http://glue.rl-community.org/Home/Extensions/matlab-codec#TOC-Frequently-Asked-Questions</A></TT>
<P>
The online FAQ may be more current than this document, which may have been distributed some time ago.

<P>

<H3><A NAME="SECTION00081200000000000000">
Google Group / Mailing List</A>
</H3>
First, you should join the RL-Glue Google Group Mailing List:
<BR>
<TT><A NAME="tex2html27"
  HREF="http://groups.google.com/group/rl-glue">http://groups.google.com/group/rl-glue</A></TT>
<P>
We're happy to answer any questions about RL-Glue.  Of course, try to search through previous messages first in case your question has been answered before.

<P>

<H1><A NAME="SECTION00090000000000000000">
Credits and Acknowledgements</A>
</H1>
Brian Tanner wrote the Matlab codec. He is also responsible for creating the installer, which is pretty nifty.  Yay Brian.

<P>

<H2><A NAME="SECTION00091000000000000000">
Contributing</A>
</H2>
If you would like to become a member of this project and contribute updates/changes to the code, please send a message to rl-glue@googlegroups.com.

<P>

<H1><A NAME="SECTION000100000000000000000">
Document Information</A>
</H1>
<PRE>
Revision Number: $Rev: 491 $
Last Updated By: $Author: brian@tannerpages.com $
Last Updated   : $Date: 2009-01-31 16:38:56 -0700 (Sat, 31 Jan 2009) $
$URL: https://rl-glue-ext.googlecode.com/svn/trunk/projects/codecs/Matlab/docs/MatlabCodec.tex $
</PRE>

<P>

<H1><A NAME="SECTION000110000000000000000">
About this document ...</A>
</H1>
 <STRONG>RL-Glue Matlab Codec 1.0 Manual </STRONG><P>
This document was generated using the
<A HREF="http://www.latex2html.org/"><STRONG>LaTeX</STRONG>2<tt>HTML</tt></A> translator Version 2002-2-1 (1.71)
<P>
Copyright &#169; 1993, 1994, 1995, 1996,
<A HREF="http://cbl.leeds.ac.uk/nikos/personal.html">Nikos Drakos</A>, 
Computer Based Learning Unit, University of Leeds.
<BR>
Copyright &#169; 1997, 1998, 1999,
<A HREF="http://www.maths.mq.edu.au/~ross/">Ross Moore</A>, 
Mathematics Department, Macquarie University, Sydney.
<P>
The command line arguments were: <BR>
 <STRONG>latex2html</STRONG> <TT>MatlabCodec.tex -split 0 -dir html -mkdir -title 'RL-Glue Matlab Codec' -local_icons -math</TT>
<P>
The translation was initiated by Brian Tanner on 2009-02-04
<BR><HR><H4>Footnotes</H4>
<DL>
<DT><A NAME="foot216">... RL-Glue</A><A
 HREF="MatlabCodec.html#tex2html1"><SUP>1</SUP></A></DT>
<DD><TT><A NAME="tex2html2"
  HREF="http://glue.rl-community.org/">http://glue.rl-community.org/</A></TT>

</DD>
<DT><A NAME="foot217">... Apache-2.0</A><A
 HREF="MatlabCodec.html#tex2html3"><SUP>2</SUP></A></DT>
<DD><TT><A NAME="tex2html4"
  HREF="http://www.apache.org/licenses/LICENSE-2.0.html">http://www.apache.org/licenses/LICENSE-2.0.html</A></TT>

</DD>
<DT><A NAME="foot222">... Extension</A><A
 HREF="MatlabCodec.html#tex2html9"><SUP>3</SUP></A></DT>
<DD><TT><A NAME="tex2html10"
  HREF="http://glue.rl-community.org/Home/Extensions/java-codec">http://glue.rl-community.org/Home/Extensions/java-codec</A></TT>

</DD>
<DT><A NAME="foot223">... string</A><A
 HREF="MatlabCodec.html#tex2html11"><SUP>4</SUP></A></DT>
<DD><TT><A NAME="tex2html12"
  HREF="http://glue.rl-community.org/Home/rl-glue/task-spec-language">http://glue.rl-community.org/Home/rl-glue/task-spec-language</A></TT>

</DD>
<DT><A NAME="foot224">... RL-Library</A><A
 HREF="MatlabCodec.html#tex2html18"><SUP>5</SUP></A></DT>
<DD><TT><A NAME="tex2html19"
  HREF="http://library.rl-community.org">http://library.rl-community.org</A></TT>

</DD>
</DL><HR>
<!--Navigation Panel-->
<IMG WIDTH="81" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next_inactive" SRC="nx_grp_g.png"> 
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_g.png"> 
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev_g.png">   
<BR>
<!--End of Navigation Panel-->
<ADDRESS>
Brian Tanner
2009-02-04
</ADDRESS>
</BODY>
</HTML>
